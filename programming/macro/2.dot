seqdiag
{
	span_height = 0;
	activation = none;
	default_fontsize = 12;
	group { T [label="Teacher"]; color = "#ffcccc"; }
	group { S [label="Student"]; color = "#ccffcc"; }
	group { PC[label="PC"];      color = "#ccccff"; }

	=== 展開: 色の符号化(15分) ===
	T => S [label="RGB色空間を説明する", return="RGB色空間での色の作り方を理解する", note="絵の具と光の調色の違いを具体例で理解させる"]
	{
		S => PC [label="RGB関数を使い別の色で塗りつぶすよう、記録したマクロを書き換える", return="指定した色でセルを塗りつぶす"]
	}

	=== 展開: セルの指定方法(10分) ===
	T -> S [label="指定したセルの色を塗るマクロを実装させる"]
	{
		S => PC [label="セルの選択を行う命令を追加する", return="指定したセルが塗られる", leftnote="VBAの入力は小文字で良い\nことを伝える"]
	}
	T -> S [label="RangeとCellsでのセルの指定方法の違いを説明する", note="行と列の指定順が逆になることを注意する"]

	=== 展開: マクロを含むファイルの保存(5分) ===
	T -> S [label="マクロを含むファイルの保存方法を説明する", note="マクロを含むか否かで拡張子が違う点を注意する"]
	{
		S => PC [label="マクロ有効ブックで保存する", return="拡張子*.xlsmで保存されることを確認する"]
	}
	T -> S [label="VBAの能力の高さとマクロウイルスの危険性を伝える"]

	=== 展開: 塗り分けマクロの実装(30分) ===
	T -> S [label="保存したファイルの開き方を説明する", return="VBAは信頼できるファイルでのみ有効化することを理解する"]
	{
		S -> PC [label="情報バーからマクロを有効化する"]
	}
	T -> S [label="VBAでの条件分岐の方法を説明する"]
	{
		S => PC [label="条件を満たせばセルを塗るよう修正する", return="セルの値により条件分岐して塗り分ける"]
	}
	T -> S [label="VBAでの反復の方法を説明する", return="for構文を理解する", note="数学のΣ記号との類似性も伝える"]
	{
		S -> PC [label="一列分のセルを判定するよう修正する"]
		S => PC [label="全列のセルを判定するよう修正する", return="二重ループに従ってセルを塗り分ける"]
	}
}
