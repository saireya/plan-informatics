seqdiag
{
	span_height = 0;
	activation = none;
	default_fontsize = 12;
	group { T [label="Teacher"]; color = "#ffcccc"; }
	group { S [label="Student"]; color = "#ccffcc"; }
	group { PC[label="PC"];      color = "#ccccff"; }

	S -> PC [label="PC,Excelを起動する"]
	S --> T [label="Excelの起動を確認する"]

	=== 導入(5分) ===
	T -> S [label="本時の内容を伝える", note="前回までのExcel関数より高度な自動化を扱うと伝える"]

	=== 展開: VBA開発環境の準備(15分) ===
	T => S [label="VBA開発環境を準備させる", return="「開発」タブの存在を確認する"]
	{
		S -> PC [label="「開発」タブを表示させる"]
	}
	T => S [label="マクロの概要を説明する", return="マクロの記録中は全操作が記録されることを理解する", note="セルの選択も記録される\nことに留意する"]
	T -> S [label="記録するマクロを設定する"]
	{
		S -> PC [label="マクロを起動するショートカットキーを設定する"]
	}
	T => S [label="マクロの記録内容を示す", return="記録したマクロの動作を確認する", note="最初は手順通りに操作することを勧める"]
	{
		S -> PC [label="セルに枠線を引くマクロを記録する"]
		S => PC [label="記録したマクロを実行する", return="選択セルに枠線を引く"]
	}
	T => S [label="記録したマクロの内容を説明する", return="記録したマクロの内容を理解する", note="他の命令が記録されていると\nマクロの動作が異なることを伝える"]

	=== 展開: 色の符号化(15分) ===
	T -> S [label="前回のcountif実習で用いたファイルを開く"]
	T -> S [label="条件でセルを塗り分けるマクロを作ることを伝える"]
	T -> S [label="セルを塗りつぶすマクロを記録させる", return="正しくマクロが記録されることを確認する"]
	{
		S -> PC [label="セルを塗りつぶす操作をマクロに記録する", leftnote="塗りつぶす色は「標準の色」から選ばせる"]
	}
}
