# 分析のための工夫,関数と統計(3時間)
単元: 社会と情報「問題解決 4.分析のための工夫, 5.関数と統計」(p.122-129)

## 本時の位置づけ
本時で扱う表計算ソフトは、それ自体が統計の重要なツールであるだけでなく、高度なシミュレーションや自動処理のための基本環境でもある。
問題解決の実践的な手順として、表計算ソフトを活用してデータを効率的に処理し、適切に分析することが必要である。

## 教材観
表計算ソフトは、セルに値を入れて記録できるだけでなく、数式をデータの内部に組み込んで自動計算できる。
表やグラフを作成するだけでなく、数式や関数を適切に用いることで、コンピュータを用いたデータ処理を効率化できる。

## 生徒観
西京高校の生徒は、各教科の授業や課題で表計算ソフトを使うほか、グラフや表を用いたプレゼンテーションの機会も多い。
しかし、それらの場面での表計算ソフトの利用は基本的な入力機能に留まり、表計算ソフトの高度な機能の恩恵を得ることは少ない。
また、中学校で表計算ソフトについて学んだ生徒が少なく、表計算ソフトの独特な操作に苦手意識を持つ生徒もいる。

## 指導観
以上より本時では、実習を通して表計算ソフトの強力な機能の便利さを学べるようにする。
九九の表の作成を通して数式のコピーやセルの絶対参照を学び、席替えプログラムの作成を通して乱数を含むExcel関数の使い方を学ぶ。
特に、テキストでは分かりにくい画面上の動作や、調べにくいが便利な機能を丁寧に指導する。
その際、セルなどの基本的な構成を説明する、マウスやキーボードの操作を画面で示すなどして、表計算ソフトに苦手意識を持つ生徒に配慮する。

## 本時の目標
- 表計算ソフトの基本的な構成と操作を理解する。
- 数式や関数とそのコピーの利便性を理解し、身近な場面で活用できる。

## 指導計画
### 1時限目
```mermaid
sequenceDiagram
	participant T
	participant S
	participant PC

Note left of T: 導入(5分)
	S->>PC: PCを起動する
	PC-->>T: PCの起動を確認する
	T->>S: 本時の内容を伝え、1時限目で目標とする九九の表を示す
	Note left of S: 単なるExcelの実習でなく、表計算ソフトに\n一般化した説明を行うよう留意する

Note left of T: 展開: 表計算ソフトの基礎(10分)
	T->>S: Excelの起動方法を説明する
	S->>PC: Excelを起動する
	PC-->T: Excelの起動を確認する

	T->>S: 表計算ソフトの画面構成を説明する
	S-->>T: セルを行名と列名で「A3セル」などと表すことを理解する
	T->>S: セルへの入力方法を説明する
	S->>PC: セルに文字や四則計算を入力する
	PC->>S: 数式の計算結果を確認する
	Note left of S: 数式の前に必ず「=」を入力することを注意する
	PC-->>T: 入力できていることを確認する

	T->>S: セルの参照方法を説明する
	S->>PC: 数式にセル番地を入力する
	PC->>S: 参照先の値により計算結果が変わることを確認する
	Note left of S: セル番地は小文字で良いことを説明する

Note left of T: 展開: セルのコピー(15分)
	T->>S: セルのコピー方法を説明する
	Note left of S: マウスの移動先やクリック操作を丁寧に説明する
	S->>PC: 「1」をコピーする
	PC->>S: 同じ数字がコピーされることを確認する
	S->>PC: 「1,2」をコピーする
	PC->>S: 連番がコピーされることを確認する
	S-->>T: セルのコピー方法を理解する
```

### 2時限目
```mermaid
sequenceDiagram
	participant T
	participant S
	participant PC

Note left of T: 展開: セルのコピー(15分)
	T->>S: 数式のコピー方法を説明する
	S->>PC: セル番地を含む数式をコピーする参照先セルが移ることを確認する
	S-->>T: 数式のコピーで入力が効率化されることを理解する

	T->>S: 「$」による参照先セルの固定方法を説明する
	S->>PC: 「$」を含む数式をコピーする
	PC->>S: 「$」の後を固定して数式がコピーされる
	Note left of S: 続けて実習するので、まだ「$」の\n使い方を理解していなくても良い

Note left of T: 展開: 九九の表の作成(15分)
	T->>S: 九九の表を作成させる
	S->>PC: 掛け算の数式をコピーする
	PC->>S: 入力した数式に従った結果を示す
	Note left of S: 適切に「$」を使い、効率的に\n表を作ることを注意する

	T->>S: 時間が余った生徒に表の装飾方法を説明する
	T->>S: 九九の表の効率的な作成法を示す
	S-->>T: 参照先セルの固定による利点を理解する

	T->>S: セル範囲の合計を求める方法を説明する
	S->>PC: オートSUMボタンで合計を求める
	PC->>S: 合計を求める数式が入力される
	T->>S: 合計のセルに入力された関数を次時で扱うことを予告する

Note left of T: 展開: ファイルの保存(5分)
	T->>S: ファイルの保存方法を伝える
	S->>PC: 作成中のファイルを保存する
	Note left of S: 休憩中に問題が生じないよう、\n1時限目の最後に行う
	PC-->>T: ファイルの保存を確認する
```

### 3時限目
```mermaid
sequenceDiagram
	participant T
	participant S
	participant PC

Note left of T: 展開: Excel関数の概要(10分)
	T->>S: 前回の復習をした上で、Excel関数について説明する
	S->>PC: sqrt,mod,sum関数を入力する
	Note left of S: 関数名の由来や「:」による\nセル範囲の指定方法も説明する
	S->>PC: if関数を入力する
	Note left of S: 関数をネストできることも説明する
	S-->>T: 関数の概要と表記を理解する

Note left of T: 展開: 乱数の生成(20分)
	T->>S: 乱数の生成方法を説明する
	S->>PC: rand関数を入力する
	PC->>S: 連続的な乱数を生成する
	S->>PC: int関数と組み合わせる
	PC->>S: 離散的な乱数を生成する
	S-->>T: 乱数の利用方法を理解する

Note left of T: 展開: 席替えプログラムの実装(20分)
	T->>S: 席替えプログラムの完成像を示す
	T->>S: 順位の算出方法を説明する
	S->>PC: rank関数を入力する
	PC->>S: 与えた乱数の順位を返す

	T->>S: 順位を座席表の形で表示させる
	S->>PC: 席替えプログラムを完成させる

Note left of T: 展開: 条件による数え上げ(20分)
	% TODO: 順位表で重複チェックに使う?
	T->>S: 数え上げの方法を説明する
	Note left of S: 条件式の記述方法が\n特殊なことに注意する
	S->>PC: countif関数を入力する

Note left of T: 展開: 条件による数え上げ(25分)
	T->>S: 多数のサイコロの目を集計させる
	S->>PC: サイコロの目の集計表を作成する

	T->>S: 範囲指定を通して「$」でのセルの固定を復習する
	Note left of S: 生徒が「$」の使い方を理解しているか確認する
	T->>S: グラフの作成方法と設定方法を説明する

Note left of T: まとめ(5分)
	T->>S: 本時で扱った表計算ソフトの基礎事項を復習する
	T->>S: 次回はVBAでより高度な自動化を行うことを伝える
```
